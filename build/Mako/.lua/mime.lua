local a=_G;local b=require("ltn12")local c=require("string")local d=mime;encodet={}decodet={}wrapt={}local function e(f)return function(g,h,i)if a.type(g)~="string"then g,h,i="default",g,h end;local j=f[g or"nil"]if not j then a.error("unknown key ("..a.tostring(g)..")",3)else return j(h,i)end end end;encodet['base64']=function()return b.filter.cycle(b64,"")end;encodet['quoted-printable']=function(k)return b.filter.cycle(qp,"",k=="binary"and"=0D=0A"or"\r\n")end;decodet['base64']=function()return b.filter.cycle(unb64,"")end;decodet['quoted-printable']=function()return b.filter.cycle(unqp,"")end;local function l(m)if m then if m==""then return"''"else return c.len(m)end else return"nil"end end;wrapt['text']=function(n)n=n or 76;return b.filter.cycle(wrp,n,n)end;wrapt['base64']=wrapt['text']wrapt['default']=wrapt['text']wrapt['quoted-printable']=function()return b.filter.cycle(qpwrp,76,76)end;encode=e(encodet)decode=e(decodet)wrap=e(wrapt)function normalize(o)return b.filter.cycle(eol,0,o)end;function stuff()return b.filter.cycle(dot,2)end;return d